% preamble.tex - Persian Linear Algebra Lecture Notes
% XeLaTeX configuration for Persian RTL support

\documentclass[12pt,a4paper,openany,oneside]{book}

% === Page Geometry ===
\usepackage{geometry}
\geometry{
    top=2.5cm,
    bottom=2.5cm,
    left=2.5cm,
    right=2.5cm,
    headheight=14pt
}

% === Math Packages (MUST come before xepersian) ===
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{bm}

% === Graphics and Diagrams ===
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usetikzlibrary{arrows.meta, calc, positioning, decorations.pathreplacing, patterns}

% === Colors and Boxes ===
\usepackage{xcolor}
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable,theorems}

% === Tables and Lists ===
\usepackage{booktabs}
\usepackage{array}
\usepackage{enumitem}

% === Hyperlinks (BEFORE xepersian) ===
\usepackage[colorlinks=true,linkcolor=blue!70!black,urlcolor=blue!70!black,citecolor=green!50!black]{hyperref}

% === Persian Support - MUST BE LAST ===
\usepackage{xepersian}

% === Font Configuration ===
% Using Tahoma as fallback (supports Persian/Arabic)
% For better typography, install XB Zar and XB Titre fonts
\settextfont[Scale=1.0]{Tahoma}
\setlatintextfont{Times New Roman}
\setdigitfont{Tahoma}
\defpersianfont\titr[Scale=1.2]{Tahoma}
\defpersianfont\nastaliq[Scale=1.0]{Tahoma}

% === Chapter and Section Styling ===
\renewcommand{\chaptername}{درس}
\renewcommand{\contentsname}{فهرست مطالب}
\renewcommand{\listfigurename}{فهرست شکل‌ها}
\renewcommand{\listtablename}{فهرست جدول‌ها}
\renewcommand{\indexname}{نمایه}
\renewcommand{\figurename}{شکل}
\renewcommand{\tablename}{جدول}
\renewcommand{\partname}{بخش}
\renewcommand{\appendixname}{پیوست}
\renewcommand{\abstractname}{چکیده}
\renewcommand{\bibname}{منابع}

% === Theorem Environments (Persian) ===
\theoremstyle{definition}
\newtheorem{definition}{تعریف}[chapter]
\newtheorem{example}{مثال}[chapter]
\newtheorem{exercise}{تمرین}[chapter]
\newtheorem{problem}{مسئله}[chapter]

\theoremstyle{plain}
\newtheorem{theorem}{قضیه}[chapter]
\newtheorem{lemma}{لم}[chapter]
\newtheorem{proposition}{گزاره}[chapter]
\newtheorem{corollary}{نتیجه}[chapter]

\theoremstyle{remark}
\newtheorem{remark}{نکته}[chapter]
\newtheorem{note}{یادداشت}[chapter]

% === Custom tcolorbox Environments ===

% Geometric Intuition Box
\newtcolorbox{intuition}{
    enhanced,
    colback=blue!5,
    colframe=blue!75!black,
    fonttitle=\titr,
    title={شهود هندسی},
    breakable,
    left=5mm,
    right=5mm,
    top=3mm,
    bottom=3mm,
    arc=2mm,
    boxrule=1pt
}

% Practical Application Box
\newtcolorbox{practical}{
    enhanced,
    colback=green!5,
    colframe=green!60!black,
    fonttitle=\titr,
    title={کاربرد عملی},
    breakable,
    left=5mm,
    right=5mm,
    top=3mm,
    bottom=3mm,
    arc=2mm,
    boxrule=1pt
}

% Warning Box
\newtcolorbox{warning}{
    enhanced,
    colback=red!5,
    colframe=red!75!black,
    fonttitle=\titr,
    title={هشدار},
    breakable,
    left=5mm,
    right=5mm,
    top=3mm,
    bottom=3mm,
    arc=2mm,
    boxrule=1pt
}

% Important Note Box
\newtcolorbox{important}{
    enhanced,
    colback=orange!5,
    colframe=orange!75!black,
    fonttitle=\titr,
    title={نکته مهم},
    breakable,
    left=5mm,
    right=5mm,
    top=3mm,
    bottom=3mm,
    arc=2mm,
    boxrule=1pt
}

% Summary Box
\newtcolorbox{summary}{
    enhanced,
    colback=purple!5,
    colframe=purple!75!black,
    fonttitle=\titr,
    title={خلاصه},
    breakable,
    left=5mm,
    right=5mm,
    top=3mm,
    bottom=3mm,
    arc=2mm,
    boxrule=1pt
}

% === Page Header/Footer ===
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LO]{\leftmark}
\fancyhead[RE]{\rightmark}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% === Spacing ===
\usepackage{setspace}
\onehalfspacing

% === Custom Commands for Math ===
\input{commands}

% === TikZ styles for linear algebra diagrams ===
\tikzset{
    vector/.style={-{Stealth[length=3mm]}, thick},
    axis/.style={-{Stealth[length=2mm]}, gray},
    grid/.style={very thin, gray!30},
    transformed/.style={blue!70},
    original/.style={black},
    basis/.style={red!70!black, very thick},
    point/.style={circle, fill, inner sep=1.5pt}
}
